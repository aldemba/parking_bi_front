<app-navbar></app-navbar>
<div class="container">
  <div class="d-flex justify-content-center posit">
    <input type="text" [(ngModel)]="searchTerm" placeholder="Rechercher..." />
  </div>
  <div class="row pad">
    <div class="col">
      <div class="text-end mb-3">
        <a class="btn btn-warning text-white"
          ><i class="fas fa-plus"></i> &nbsp;Ajouter</a
        >
      </div>
      <div *ngIf="voitures.length == 0" class="text-center my-3">
        <h1>Vous n'avez pas encore de voitures, veuillez en ajouter.</h1>
      </div>
      <div *ngIf="voitures.length > 0" class="table-responsive">
        <table class="table table-striped table-bordered nowrap shadow">
          <thead class="table-dark">
            <tr>
              <th scope="col">Image</th>
              <th scope="col">Nom</th>
              <th scope="col">Matricule</th>
              <th scope="col">Marque</th>
              <th scope="col">Modèle</th>
              <th scope="col">Assurance</th>
              <th scope="col">Visite Technique</th>
              <th scope="col">Statut</th>
              <th scope="col">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr
              *ngFor="
                let voiture of voitures
                  | filter : searchTerm
                  | paginate
                    : {
                        itemsPerPage: searchItemsPerPage(),
                        currentPage: page,
                        totalItems: totalLength
                      }
              "
            >
              <th scope="row">
                <img
                  class="img"
                  src="data:image/PNG;base64, {{ voiture.image }}"
                  alt=""
                />
              </th>
              <td>{{ voiture.nom }}</td>
              <td>{{ voiture.matricule }}</td>
              <td>{{ voiture.marque }}</td>
              <td>{{ voiture.modele }}</td>
              <td>{{ voiture.assurance.date_fin }}</td>
              <td>{{ voiture.visite.date_fin_visite }}</td>
              <td>
                <select
                  class="etat"
                  [(ngModel)]="voiture.etat"
                  (change)="updateEtat(voiture)"
                >
                  <option value="DISPONIBLE">Disponible</option>
                  <option value="INDISPONIBLE">Indisponible</option>
                </select>
              </td>
              <td>
                <a
                  class="text-warning me-4"
                  (click)="afficherDetailsVoiture(voiture)"
                >
                  <i
                    class="fa fa-eye"
                    data-bs-toggle="modal"
                    data-bs-target="#myModal"
                  ></i>
                </a>
                <a class="text-danger">
                  <i class="fa fa-trash"></i>
                </a>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
  <div class="modal posi" id="myModal">
    <div class="modal-dialog posi">
      <div class="modal-content tall">
        <div class="modal-header">
          <h1 class="h5 modal-title">Details Voiture</h1>
          <button
            class="btn-close"
            type="button"
            data-bs-dismiss="modal"
          ></button>
        </div>
        <div class="modal-body d-flex">
          <div>
            <img
              class="imgbis"
              src="data:image/PNG;base64, {{ voitureSelectionnee?.image }}"
              alt=""
            />
          </div>
          <div>
          
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-warning text-white" data-bs-dismiss="modal">
            Editer
          </button>
        </div>
      </div>
    </div>
  </div>
  <div
    class="row justify-content-end"
    *ngIf="!searchTerm && voitures.length > 0"
  >
    <div class="col-auto">
      <pagination-controls
        class="pagination"
        previousLabel="Précédent"
        nextLabel="Suivant"
        (pageChange)="page = $event"
      ></pagination-controls>
    </div>
  </div>
</div>
